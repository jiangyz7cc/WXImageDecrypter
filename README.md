# 微信图片解密工具
缓存的图片位于：WeChat Files\wxid_...\FileStorage\Image目录下，当前版本的微信加密了这些图片，为了能够查看，就要解密，转换成正常编码的图片。

从网上查到，微信目前使用异或加密方法，只要知道密钥就能逐个字节异或解密。

微信保存的图片格式有：jpg, png，基本就是这两种，可能还有gif（个别图片转换错误不知道什么编码）。

## 解密方法：
根据异或的特性，得出以下状态转换：

	密钥 ^ 原始字节 => 加密的字节
	key^b=>bn

	密钥 <= 加密的字节 ^ 原始字节
	key=bn^b

	密钥 ^ 加密的字节 => 原始字节
	key^bn=b

只要先假设前几个文件头字节属于微信保存的几种图片类型之一就可以猜出密钥。

例如：
jpg类型的图片，头字节为：FF D8

加密的头部字节为：3C 1B 3C 23

首字节3C与jpg首字节FF异或，得到密钥（假设）
	3C^FF=C3

再用该密钥异或解密下一个字节1B
	1B^C3=D8

看得到的新字节是否等于jpg的第二字节，相等就判断文件类型为jpg，不等再进行其他类型的判断。

判断出文件类型后，即得到密钥，用该密钥与剩下的字节逐个进行异或运算，把结果接入文件，解密完成。
